@import "global-variables";

html, body {
	margin: 0;
	padding: 0;
	min-height: 100%;
	height: 100%;
	position: relative;
}

.page-map {
	#top-level-nav-wrapper,
	header,
	.tabs,
	footer {
		display: none;
	}

	#content {
		// SASS stuff
		$padding: 15px;
		$dockWidth: 300px;
		$menuHeight: 45px;
		$mapAssets: '/sites/all/modules/custom/calacademy_map/images/';

		@mixin title-style {
			font-weight: $medium;
    		font-size: $slightlyLargerText;
    		line-height: 1.2em;

    		a {
    			color: $international-orange;
    			@include arrow('arrow-orange');
    			padding-top: 2px;
    		}
		}

		@mixin color-fade {
			@include transition(
				background-color .3s ease
			);
		}

		// some basic resets
		& > article,
		& > #main-content {
			display: none;
		}

		overflow: hidden;
		position: absolute;
		width: 100%;
		max-width: inherit;
	    top: 0;
	    bottom: 0;
	    left: 0;
	    right: 0;
	    z-index: 1;

	    padding: 0;
	    padding-top: $navHeight;

		.map-ui ul,
		.map-zoom-controls {
			margin: 0;
	    	padding: 0;
	    	list-style-type: none;
		}

		.map-ui,
		.map-zoom-controls {
			&, * {
				-webkit-touch-callout: none;
				@include user-select(none);
			}
		}

		// google map
	    .calacademy_geolocation_map {
			position: relative;
			height: 100%;
			float: left;
			@include calc(width, (100% - #{$dockWidth}), 70%);

			&, .gm-style, select {
				font-family: 'Whitney A', 'Whitney B', Helvetica, Arial, sans-serif !important;
			}

			img {
				max-width: inherit !important;
			}

			.gm-style-cc,
			a[href^="http://maps.google.com/maps"],
			a[href^="https://maps.google.com/maps"] {
				display: none !important;
			}

			.map-zoom-controls {
				position: relative;
				z-index: 1;
				float: right;

				margin-top: $padding;
				margin-right: $padding;

				li {
					@include box-sizing(border-box);
					@include hand-cursor;

					width: 30px;
					height: 30px;
					padding: 5px;
					overflow: hidden;
					background-color: $white;
					margin-bottom: 1px;
					font-weight: $semibold;
					text-align: center;
					font-size: $smartphoneText;
					line-height: 1;

					color: #999999;
					-webkit-font-smoothing: none;
					font-smoothing: none;
					font-smooth: never;
				}
			}
		}

		// item descriptions
		.map-dock,
	    .map-dock-smartphone {
			.map-item-container {
				padding: $padding;

				img {
					float: left;
					width: 60px;
					height: 60px;
					margin-right: $padding;
					margin-bottom: $padding;
				}

				.text-container {
					.title {
			    		margin: 0;
			    		padding: 0;
			    		@include title-style;
			    	}

					.details-desc {
						margin-top: $padding - 8px;
						line-height: 1.4em;

						@include respond-to(smartphone) {
							font-size: $defaultText;
							line-height: $defaultLineHeight - 2px;
						}
					}
				}
			}
		}

		// smartphone dock
		.map-dock-smartphone {
			border-top: $map-border;
			background-color: $map-grey-pale;
			display: none;
			position: absolute;
			z-index: 100;
			width: 100%;
			bottom: 100000000px;
		}

		// menu
		.map-ui {
			float: left;
			@include calc(width, $dockWidth, 30%);

			.map-menus {
				position: relative;
				z-index: 2;
				width: 100%;
				border-bottom: $map-border;

				.titles {
					position: relative;
					z-index: 1;
					width: 100%;
					overflow: auto;

					div {
						@include hand-cursor;

						span {
							@include box-sizing(border-box);
							@include title-style;
							display: block;
							padding: $padding;
							height: $menuHeight;
						}

						// Floor switcher
						&#title-floor {
							float: left;

				    		// down arrow
				    		span {
				    			$arrowWidth: 16px;
								padding-right: $arrowWidth + 10px;

								@include background-image-retina(drop-down-arrow, png, $arrowWidth, 9px);
								background-repeat: no-repeat;
								background-position: right 20px;
				    		}
				    	}

				    	&#title-filter,
				    	&#title-list-toggle {
				    		float: right;

				    		span {
				    			border-left: $map-border;
				    		}
				    	}

				    	// Type filter
				    	&#title-filter {
				    		// pin
				    		span {
				    			@include hide-text-calacademy;

				    			$w: 14px;
				    			$h: 20px;

				    			width: $w + ($padding * 2);
				    			background-image: url($mapAssets + 'icons/pin.svg');
				    			background-size: $w $h;
				    			background-position: center;
				    			background-repeat: no-repeat;

				    			// @include color-fade;
				    			background-color: $white;

				    			.filter-menu-open & {
				    				background-color: $map-grey;
				    			}
				    		}
				    	}

				    	// Map / List
					    &#title-list-toggle {
							display: none;
							color: $international-orange;
						}
					}
				}

				.options {
					// position: absolute;
					// top: $menuHeight;
					// width: 100%;
					// background-color: rgba(255, 255, 255, .9);

					// @include transition(
					// 	height .5s ease
					// );

					// height: 0;
					// overflow: hidden;

					// .floor-menu-open &,
					// .filter-menu-open & {
					// 	height: 100px;
					// }

					ul {
		    			display: none;

		    			.floor-menu-open &#options-floor,
		    			.filter-menu-open &#options-filter {
		    				display: block;
		    			}

		    			// style
		    			border-top: $map-border;
		    			padding: $padding;

		    			li {
		    				margin-bottom: 5px;

		    				&:last-child {
		    					margin-bottom: 0;
		    				}

		    				a {
			    				color: $black;
			    				font-size: $scienceTodayMedium;
	    						line-height: $scienceTodayMediumLineHeight;

			    				&.selected {
			    					color: $international-orange;
			    				}
			    			}
		    			}

		    			&#options-filter {
			    			span {
		    					display: block;
		    					float: left;
		    					margin-right: 5px;
		    					margin-top: 3px;

		    					@include respond-to(smartphone) {
		    						margin-top: 1px;
		    					}

		    					&, svg {
		    						width: 11px;
		    						height: 17px;
		    					}

		    					svg {
		    						@include transition(
		    							fill .3s ease
		    						);

		    						fill: $map-dark-grey;
		    					}

		    					&.selected {
		    						svg {
		    							fill: $international-orange;
		    						}
		    					}
		    				}
			    		}
		    		}
				}
			}

			.map-dock {
				clear: both;
				overflow: scroll;
				-webkit-overflow-scrolling: touch;

				li {
					@include hand-cursor;
					@include color-fade;
					border-bottom: $map-border;
					background-color: $map-grey-light;

					&.selected {
						background-color: $map-grey;
					}
					&.not-in-filter-selection {
						display: none !important;
					}

					// hide item unless on selected floor
					display: none;
				}
				.map-floor-aq & li.aq {
					display: block;
				}
				.map-floor-main & li.main {
					display: block;
				}
				.map-floor-l2 & li.l2 {
					display: block;
				}
				.map-floor-l3 & li.l3 {
					display: block;
				}
				.map-floor-roof & li.roof {
					display: block;
				}
			}
		}

		@include respond-to(smartphone) {
			padding-top: $smartphoneNavHeight;

			// dock
			.map-dock-smartphone {
				bottom: 0;

				.map-list-selected & {
					bottom: 10000000px;
				}
			}

			.calacademy_geolocation_map,
			.map-ui {
				width: 100% !important;
				float: none;
			}

			.calacademy_geolocation_map {
				position: absolute !important;
				top: $menuHeight + $smartphoneNavHeight !important;
				@include calc(height, (100% - #{($menuHeight + $smartphoneNavHeight)}), 100%);
				z-index: 1;

				.map-zoom-controls {
					display: none;
				}
			}

			.map-ui {
				position: relative;
				z-index: 2;

				.map-menus {
					background-color: $white;

					.titles {
						// list toggle
						div#title-list-toggle {
							display: block;
						}
					}
				}

				.map-dock {
					display: none;

					.map-list-selected & {
						display: block;
					}
				}
			}
		}
	}
}
